train.py:86: DtypeWarning: Columns (1,2,3) have mixed types.Specify dtype option on import or set low_memory=False.
  train_data, val_data, timestamp, scaler = get_data(args, input_window, output_window, device=device)
D:\PythonProject\Time_series_anomaly_detection\weights\2022_02_06 20_54_15
find port id.
find polution id.
find company id.
         company_id                port_id polution_id       date  concentration   amount
0    17280000089583  64000000000600100000       w00000 2020-01-01          66.25   870.00
1    17280000089583  64000000000600100000       w00000 2020-01-02          73.18  1758.00
2    17280000089583  64000000000600100000       w00000 2020-01-03          79.95  1918.00
3    17280000089583  64000000000600100000       w00000 2020-01-04          69.91  1678.00
4    17280000089583  64000000000600100000       w00000 2020-01-05            NaN    74.00
5    17280000089583  64000000000600100000       w00000 2020-01-06            NaN   152.00
6    17280000089583  64000000000600100000       w00000 2020-01-20            NaN   156.00
7    17280000089583  64000000000600100000       w00000 2020-01-21            NaN    80.00
168  17280000089583  64000000000600100000       w00000 2020-01-07          34.50  2976.00
169  17280000089583  64000000000600100000       w00000 2020-01-08         112.50  9724.90
170  17280000089583  64000000000600100000       w00000 2020-01-09          26.80  2314.00
171  17280000089583  64000000000600100000       w00000 2020-01-10          22.40  1944.00
172  17280000089583  64000000000600100000       w00000 2020-01-11          20.60  1780.00
173  17280000089583  64000000000600100000       w00000 2020-01-12          19.30  1668.00
174  17280000089583  64000000000600100000       w00000 2020-01-13          20.20  1744.00
175  17280000089583  64000000000600100000       w00000 2020-01-14          21.70  1876.39
176  17280000089583  64000000000600100000       w00000 2020-01-15          33.80  2920.00
177  17280000089583  64000000000600100000       w00000 2020-01-16          32.10  2776.00
178  17280000089583  64000000000600100000       w00000 2020-01-17          20.50  1774.00
179  17280000089583  64000000000600100000       w00000 2020-01-18          23.70  2052.00
180  17280000089583  64000000000600100000       w00000 2020-01-19          29.80  2570.00
181  17280000089583  64000000000600100000       w00000 2020-01-22          24.80  2144.96
182  17280000089583  64000000000600100000       w00000 2020-01-23          20.90  1806.00
183  17280000089583  64000000000600100000       w00000 2020-01-24          19.50  1690.00
184  17280000089583  64000000000600100000       w00000 2020-01-25          19.80  1712.00
185  17280000089583  64000000000600100000       w00000 2020-01-26          27.70  2396.00
186  17280000089583  64000000000600100000       w00000 2020-01-27          45.00  3888.00
187  17280000089583  64000000000600100000       w00000 2020-01-28          20.40  1762.00
188  17280000089583  64000000000600100000       w00000 2020-01-29          22.80  1970.00
189  17280000089583  64000000000600100000       w00000 2020-01-30          20.10  1736.00
190  17280000089583  64000000000600100000       w00000 2020-01-31          20.50  1776.00
191  17280000089583  64000000000600100000       w00000 2020-02-01          20.60  1782.00
dim_name:  concentration
-----------------------------------------------
series:  0       66.25
1       73.18
2       79.95
3       69.91
4        0.00
5        0.00
6        0.00
7        0.00
168     34.50
169    112.50
170     26.80
171     22.40
172     20.60
173     19.30
174     20.20
175     21.70
176     33.80
177     32.10
178     20.50
179     23.70
180     29.80
181     24.80
182     20.90
183     19.50
184     19.80
185     27.70
186     45.00
187     20.40
188     22.80
189     20.10
190     20.50
191     20.60
Name: concentration, dtype: float64
series.shape:  (32,)
-----------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch   1 | time:  0.09s | valid loss 16.99852
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch   2 | time:  0.09s | valid loss 0.98398
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch   3 | time:  0.10s | valid loss 0.24687
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch   4 | time:  0.09s | valid loss 0.33603
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch   5 | time:  0.09s | valid loss 0.19338
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch   6 | time:  0.09s | valid loss 0.22535
-----------------------------------------------------------------------------------------
D:\PythonProject\Time_series_anomaly_detection\utils\data_prepare.py:18: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at  ..\torch\csrc\utils\tensor_new.cpp:201.)
  return torch.FloatTensor(inout_seq)
D:\miniconda\envs\pytorch\lib\site-packages\matplotlib\text.py:1223: FutureWarning: elementwise comparison failed; returning scalar instead, but in the future will perform elementwise comparison
  if s != self._text:
-----------------------------------------------------------------------------------------
| end of epoch   7 | time:  0.10s | valid loss 0.26358
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch   8 | time:  0.10s | valid loss 0.17209
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch   9 | time:  0.10s | valid loss 0.16816
-----------------------------------------------------------------------------------------
save successfully
loss shape:  (30,)
-----------------------------------------------------------------------------------------
| end of epoch  10 | time:  1.33s | valid loss 0.23256
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  11 | time:  0.09s | valid loss 0.15557
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  12 | time:  0.09s | valid loss 0.15892
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  13 | time:  0.09s | valid loss 0.17716
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  14 | time:  0.08s | valid loss 0.15992
-----------------------------------------------------------------------------------------
D:\miniconda\envs\pytorch\lib\site-packages\matplotlib\text.py:1223: FutureWarning: elementwise comparison failed; returning scalar instead, but in the future will perform elementwise comparison
  if s != self._text:
-----------------------------------------------------------------------------------------
| end of epoch  15 | time:  0.10s | valid loss 0.14469
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  16 | time:  0.09s | valid loss 0.15046
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  17 | time:  0.09s | valid loss 0.14502
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  18 | time:  0.09s | valid loss 0.14868
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  19 | time:  0.10s | valid loss 0.15360
-----------------------------------------------------------------------------------------
loss shape:  (30,)
-----------------------------------------------------------------------------------------
| end of epoch  20 | time:  1.05s | valid loss 0.17732
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  21 | time:  0.08s | valid loss 0.14204
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  22 | time:  0.09s | valid loss 0.14104
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  23 | time:  0.09s | valid loss 0.13874
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  24 | time:  0.09s | valid loss 0.14198
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  25 | time:  0.09s | valid loss 0.13708
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  26 | time:  0.08s | valid loss 0.12949
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  27 | time:  0.09s | valid loss 0.12572
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  28 | time:  0.09s | valid loss 0.12099
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  29 | time:  0.09s | valid loss 0.12685
-----------------------------------------------------------------------------------------
loss shape:  (30,)
-----------------------------------------------------------------------------------------
| end of epoch  30 | time:  1.09s | valid loss 0.15606
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  31 | time:  0.08s | valid loss 0.10358
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  32 | time:  0.09s | valid loss 0.13161
-----------------------------------------------------------------------------------------
D:\miniconda\envs\pytorch\lib\site-packages\matplotlib\text.py:1223: FutureWarning: elementwise comparison failed; returning scalar instead, but in the future will perform elementwise comparison
  if s != self._text:
D:\miniconda\envs\pytorch\lib\site-packages\matplotlib\text.py:1223: FutureWarning: elementwise comparison failed; returning scalar instead, but in the future will perform elementwise comparison
  if s != self._text:
-----------------------------------------------------------------------------------------
| end of epoch  33 | time:  0.10s | valid loss 0.08757
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  34 | time:  0.09s | valid loss 0.09285
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  35 | time:  0.09s | valid loss 0.10323
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  36 | time:  0.09s | valid loss 0.08064
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  37 | time:  0.10s | valid loss 0.07676
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  38 | time:  0.09s | valid loss 0.07101
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  39 | time:  0.09s | valid loss 0.06764
-----------------------------------------------------------------------------------------
save successfully
loss shape:  (30,)
-----------------------------------------------------------------------------------------
| end of epoch  40 | time:  1.11s | valid loss 0.06380
-----------------------------------------------------------------------------------------
save successfully
D:\miniconda\envs\pytorch\lib\site-packages\matplotlib\text.py:1223: FutureWarning: elementwise comparison failed; returning scalar instead, but in the future will perform elementwise comparison
  if s != self._text:
-----------------------------------------------------------------------------------------
| end of epoch  41 | time:  0.10s | valid loss 0.04966
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  42 | time:  0.10s | valid loss 0.05158
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  43 | time:  0.10s | valid loss 0.05054
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  44 | time:  0.10s | valid loss 0.06349
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  45 | time:  0.10s | valid loss 0.04730
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  46 | time:  0.09s | valid loss 0.04865
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  47 | time:  0.09s | valid loss 0.04957
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  48 | time:  0.09s | valid loss 0.05278
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  49 | time:  0.09s | valid loss 0.04991
-----------------------------------------------------------------------------------------
loss shape:  (30,)
-----------------------------------------------------------------------------------------
| end of epoch  50 | time:  1.14s | valid loss 0.05564
-----------------------------------------------------------------------------------------
D:\miniconda\envs\pytorch\lib\site-packages\matplotlib\text.py:1223: FutureWarning: elementwise comparison failed; returning scalar instead, but in the future will perform elementwise comparison
  if s != self._text:
-----------------------------------------------------------------------------------------
| end of epoch  51 | time:  0.11s | valid loss 0.04645
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  52 | time:  0.10s | valid loss 0.04518
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  53 | time:  0.10s | valid loss 0.04616
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  54 | time:  0.09s | valid loss 0.05238
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  55 | time:  0.10s | valid loss 0.06069
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  56 | time:  0.10s | valid loss 0.04874
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  57 | time:  0.10s | valid loss 0.04240
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  58 | time:  0.09s | valid loss 0.04475
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  59 | time:  0.09s | valid loss 0.04754
-----------------------------------------------------------------------------------------
loss shape:  (30,)
D:\miniconda\envs\pytorch\lib\site-packages\matplotlib\text.py:1223: FutureWarning: elementwise comparison failed; returning scalar instead, but in the future will perform elementwise comparison
  if s != self._text:
-----------------------------------------------------------------------------------------
| end of epoch  60 | time:  1.18s | valid loss 0.05732
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  61 | time:  0.10s | valid loss 0.04803
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  62 | time:  0.10s | valid loss 0.05571
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  63 | time:  0.09s | valid loss 0.05856
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  64 | time:  0.10s | valid loss 0.05540
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  65 | time:  0.09s | valid loss 0.04104
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  66 | time:  0.10s | valid loss 0.04318
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  67 | time:  0.10s | valid loss 0.04442
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  68 | time:  0.09s | valid loss 0.04314
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  69 | time:  0.11s | valid loss 0.04179
-----------------------------------------------------------------------------------------
loss shape:  (30,)
D:\miniconda\envs\pytorch\lib\site-packages\matplotlib\text.py:1223: FutureWarning: elementwise comparison failed; returning scalar instead, but in the future will perform elementwise comparison
  if s != self._text:
-----------------------------------------------------------------------------------------
| end of epoch  70 | time:  1.52s | valid loss 0.05653
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  71 | time:  0.10s | valid loss 0.04875
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  72 | time:  0.20s | valid loss 0.04940
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  73 | time:  0.09s | valid loss 0.04555
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  74 | time:  0.09s | valid loss 0.04266
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  75 | time:  0.10s | valid loss 0.03717
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  76 | time:  0.09s | valid loss 0.03560
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  77 | time:  0.09s | valid loss 0.03741
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  78 | time:  0.10s | valid loss 0.04088
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  79 | time:  0.11s | valid loss 0.04133
-----------------------------------------------------------------------------------------
loss shape:  (30,)
-----------------------------------------------------------------------------------------
| end of epoch  80 | time:  1.16s | valid loss 0.04708
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  81 | time:  0.09s | valid loss 0.03649
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  82 | time:  0.10s | valid loss 0.03626
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  83 | time:  0.10s | valid loss 0.03555
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  84 | time:  0.11s | valid loss 0.03522
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  85 | time:  0.09s | valid loss 0.03927
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  86 | time:  0.10s | valid loss 0.04070
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  87 | time:  0.16s | valid loss 0.03707
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  88 | time:  0.22s | valid loss 0.03371
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  89 | time:  0.10s | valid loss 0.03418
-----------------------------------------------------------------------------------------
D:\miniconda\envs\pytorch\lib\site-packages\matplotlib\text.py:1223: FutureWarning: elementwise comparison failed; returning scalar instead, but in the future will perform elementwise comparison
  if s != self._text:
loss shape:  (30,)
-----------------------------------------------------------------------------------------
| end of epoch  90 | time:  1.26s | valid loss 0.04391
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  91 | time:  0.10s | valid loss 0.03610
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  92 | time:  0.10s | valid loss 0.03517
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  93 | time:  0.10s | valid loss 0.03471
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  94 | time:  0.09s | valid loss 0.03387
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  95 | time:  0.10s | valid loss 0.03242
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  96 | time:  0.10s | valid loss 0.03138
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  97 | time:  0.10s | valid loss 0.03023
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  98 | time:  0.09s | valid loss 0.02945
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  99 | time:  0.09s | valid loss 0.02996
-----------------------------------------------------------------------------------------
loss shape:  (30,)
-----------------------------------------------------------------------------------------
| end of epoch 100 | time:  1.15s | valid loss 0.03776
-----------------------------------------------------------------------------------------
D:\miniconda\envs\pytorch\lib\site-packages\matplotlib\text.py:1223: FutureWarning: elementwise comparison failed; returning scalar instead, but in the future will perform elementwise comparison
  if s != self._text: