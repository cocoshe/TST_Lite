D:\PythonProject\Time_series_anomaly_detection\utils\data_prepare.py:18: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at  ..\torch\csrc\utils\tensor_new.cpp:201.)
  return torch.FloatTensor(inout_seq)
D:\PythonProject\Time_series_anomaly_detection\weights\2022_02_11 19_50_18
       company_id       port_id polution_id                 date  concentration    amount
0    1.728000e+13  6.400000e+19      w00000    1/1/2021 00:00:00           29.9  2047.590
1    1.728000e+13  6.400000e+19      w00000    2/1/2021 00:00:00           30.6  2648.000
2    1.728000e+13  6.400000e+19      w00000    3/1/2021 00:00:00           24.8  2142.000
3    1.728000e+13  6.400000e+19      w00000    4/1/2021 00:00:00           37.2  3218.000
4    1.728000e+13  6.400000e+19      w00000    5/1/2021 00:00:00           21.0  1818.000
..            ...           ...         ...                  ...            ...       ...
304  1.728000e+13  6.400000e+19      w00000  25/11/2021 00:00:00           41.7  3600.563
305  1.728000e+13  6.400000e+19      w00000  26/11/2021 00:00:00           35.3  1525.746
306  1.728000e+13  6.400000e+19      w00000  27/11/2021 00:00:00            0.0     0.000
307  1.728000e+13  6.400000e+19      w00000  28/11/2021 00:00:00           39.8   858.972
308  1.728000e+13  6.400000e+19      w00000  29/11/2021 00:00:00           41.9  3616.834
[309 rows x 6 columns]
-----------------------------------------------
series:  0      29.9
1      30.6
2      24.8
3      37.2
4      21.0
       ...
304    41.7
305    35.3
306     0.0
307    39.8
308    41.9
Name: concentration, Length: 309, dtype: float64
series.shape:  (309,)
-----------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch   1 | time:  1.95s | valid loss 0.19188
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch   2 | time:  1.79s | valid loss 0.06056
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch   3 | time:  1.73s | valid loss 0.02806
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch   4 | time:  1.76s | valid loss 0.04514
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch   5 | time:  1.74s | valid loss 0.08618
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch   6 | time:  1.75s | valid loss 0.05165
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch   7 | time:  1.72s | valid loss 0.02784
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch   8 | time:  1.77s | valid loss 0.03312
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch   9 | time:  1.77s | valid loss 0.03303
-----------------------------------------------------------------------------------------
loss shape:  (307,)
-----------------------------------------------------------------------------------------
| end of epoch  10 | time:  3.28s | valid loss 0.02848
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  11 | time:  1.83s | valid loss 0.04600
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  12 | time:  1.72s | valid loss 0.03452
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  13 | time:  1.76s | valid loss 0.02734
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  14 | time:  1.79s | valid loss 0.03629
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  15 | time:  1.77s | valid loss 0.03222
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  16 | time:  1.76s | valid loss 0.02741
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  17 | time:  1.85s | valid loss 0.07416
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  18 | time:  1.75s | valid loss 0.04200
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  19 | time:  1.75s | valid loss 0.02864
-----------------------------------------------------------------------------------------
loss shape:  (307,)
-----------------------------------------------------------------------------------------
| end of epoch  20 | time:  3.15s | valid loss 0.04843
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  21 | time:  1.83s | valid loss 0.03493
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  22 | time:  1.78s | valid loss 0.02734
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  23 | time:  1.81s | valid loss 0.07154
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  24 | time:  1.88s | valid loss 0.04136
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  25 | time:  1.86s | valid loss 0.02740
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  26 | time:  1.93s | valid loss 0.08347
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  27 | time:  2.00s | valid loss 0.04033
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  28 | time:  2.00s | valid loss 0.03575
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  29 | time:  1.89s | valid loss 0.05469
-----------------------------------------------------------------------------------------
loss shape:  (307,)
-----------------------------------------------------------------------------------------
| end of epoch  30 | time:  3.68s | valid loss 0.03364
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  31 | time:  2.42s | valid loss 0.03107
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  32 | time:  2.72s | valid loss 0.05572
-----------------------------------------------------------------------------------------
Traceback (most recent call last):
  File "train.py", line 139, in <module>
    main(args)
  File "train.py", line 109, in main
    val_loss = evaluate(model, val_data, criterion, input_window)
  File "D:\PythonProject\Time_series_anomaly_detection\utils\eval.py", line 13, in evaluate
    output = eval_model(data)  # [seq_len(input_window), batch_size, dim]
  File "D:\miniconda\envs\pytorch\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "D:\PythonProject\Time_series_anomaly_detection\model\Transformer.py", line 35, in forward
    output = self.transformer_encoder(src, self.src_mask)  # , self.src_mask)
  File "D:\miniconda\envs\pytorch\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "D:\miniconda\envs\pytorch\lib\site-packages\torch\nn\modules\transformer.py", line 198, in forward
    output = mod(output, src_mask=mask, src_key_padding_mask=src_key_padding_mask)
  File "D:\miniconda\envs\pytorch\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "D:\miniconda\envs\pytorch\lib\site-packages\torch\nn\modules\transformer.py", line 340, in forward
    x = self.norm2(x + self._ff_block(x))
  File "D:\miniconda\envs\pytorch\lib\site-packages\torch\nn\modules\transformer.py", line 355, in _ff_block
    x = self.linear2(self.dropout(self.activation(self.linear1(x))))
  File "D:\miniconda\envs\pytorch\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "D:\miniconda\envs\pytorch\lib\site-packages\torch\nn\modules\linear.py", line 103, in forward
    return F.linear(input, self.weight, self.bias)
  File "D:\miniconda\envs\pytorch\lib\site-packages\torch\nn\functional.py", line 1848, in linear
    return torch._C._nn.linear(input, weight, bias)
KeyboardInterrupt