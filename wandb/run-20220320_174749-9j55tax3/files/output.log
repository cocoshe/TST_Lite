
| epoch   1 |    10/  173 batches | lr 0.001000 | 251.53 ms | loss 0.63765
| epoch   1 |    20/  173 batches | lr 0.001000 | 256.14 ms | loss 0.17667
| epoch   1 |    30/  173 batches | lr 0.001000 | 237.24 ms | loss 0.13564
| epoch   1 |    40/  173 batches | lr 0.001000 | 221.92 ms | loss 0.11866
| epoch   1 |    50/  173 batches | lr 0.001000 | 245.02 ms | loss 0.11615
| epoch   1 |    60/  173 batches | lr 0.001000 | 262.25 ms | loss 0.11572
| epoch   1 |    70/  173 batches | lr 0.001000 | 229.88 ms | loss 0.11646
| epoch   1 |    80/  173 batches | lr 0.001000 | 241.52 ms | loss 0.11514
| epoch   1 |    90/  173 batches | lr 0.001000 | 272.61 ms | loss 0.11623
| epoch   1 |   100/  173 batches | lr 0.001000 | 232.62 ms | loss 0.11507
| epoch   1 |   110/  173 batches | lr 0.001000 | 236.35 ms | loss 0.11432
| epoch   1 |   120/  173 batches | lr 0.001000 | 236.61 ms | loss 0.11571
| epoch   1 |   130/  173 batches | lr 0.001000 | 241.76 ms | loss 0.11329
| epoch   1 |   140/  173 batches | lr 0.001000 | 222.95 ms | loss 0.11831
| epoch   1 |   150/  173 batches | lr 0.001000 | 228.20 ms | loss 0.10935
| epoch   1 |   160/  173 batches | lr 0.001000 | 235.99 ms | loss 0.11760
| epoch   1 |   170/  173 batches | lr 0.001000 | 226.81 ms | loss 0.11057
data_source shape: torch.Size([11084, 2, 100, 6])
output shape: torch.Size([100, 1, 6])
output[[0]].shape: torch.Size([1, 1, 6])
output[:-1].shape: torch.Size([99, 1, 6])
truth shape: torch.Size([11183, 6])
test_result shape: torch.Size([11183, 6])
output truth shape: (11183, 6)
output test_result shape: (11183, 6)
test_result[0].shape, type (6,) float64
test_result.shape, type (11183, 6) float64
loss shape:  (11183, 6)
---------------------------------
start SVM
---------------------------------
精度为0.97362539114886
precision:  0.7758620689655172  recall:  0.8653846153846154  acc:  0.9910578556737906  f1:  0.8181818181818181
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 138.35s | valid loss 0.11205
-----------------------------------------------------------------------------------------
save successfully
| epoch   2 |    10/  173 batches | lr 0.001000 | 269.65 ms | loss 0.11935
| epoch   2 |    20/  173 batches | lr 0.001000 | 223.94 ms | loss 0.10994
| epoch   2 |    30/  173 batches | lr 0.001000 | 226.82 ms | loss 0.11495
| epoch   2 |    40/  173 batches | lr 0.001000 | 222.74 ms | loss 0.10904
| epoch   2 |    50/  173 batches | lr 0.001000 | 224.86 ms | loss 0.11084
| epoch   2 |    60/  173 batches | lr 0.001000 | 232.94 ms | loss 0.11142
| epoch   2 |    70/  173 batches | lr 0.001000 | 225.52 ms | loss 0.11263
| epoch   2 |    80/  173 batches | lr 0.001000 | 232.56 ms | loss 0.11150
| epoch   2 |    90/  173 batches | lr 0.001000 | 227.46 ms | loss 0.11250
| epoch   2 |   100/  173 batches | lr 0.001000 | 220.67 ms | loss 0.11124
| epoch   2 |   110/  173 batches | lr 0.001000 | 226.50 ms | loss 0.11112
| epoch   2 |   120/  173 batches | lr 0.001000 | 228.83 ms | loss 0.11283
| epoch   2 |   130/  173 batches | lr 0.001000 | 231.85 ms | loss 0.11079
| epoch   2 |   140/  173 batches | lr 0.001000 | 236.01 ms | loss 0.11567
| epoch   2 |   150/  173 batches | lr 0.001000 | 234.31 ms | loss 0.10692
| epoch   2 |   160/  173 batches | lr 0.001000 | 231.53 ms | loss 0.11528
| epoch   2 |   170/  173 batches | lr 0.001000 | 234.85 ms | loss 0.10890
data_source shape: torch.Size([11084, 2, 100, 6])
output shape: torch.Size([100, 1, 6])
output[[0]].shape: torch.Size([1, 1, 6])
output[:-1].shape: torch.Size([99, 1, 6])
truth shape: torch.Size([11183, 6])
test_result shape: torch.Size([11183, 6])
output truth shape: (11183, 6)
output test_result shape: (11183, 6)
test_result[0].shape, type (6,) float64
test_result.shape, type (11183, 6) float64
loss shape:  (11183, 6)
---------------------------------
start SVM
---------------------------------
精度为0.97362539114886
precision:  0.8862745098039215  recall:  0.8692307692307693  acc:  0.994366449074488  f1:  0.8776699029126214
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 137.48s | valid loss 0.11053
-----------------------------------------------------------------------------------------
save successfully
| epoch   3 |    10/  173 batches | lr 0.001000 | 270.19 ms | loss 0.11757
| epoch   3 |    20/  173 batches | lr 0.001000 | 249.01 ms | loss 0.10811
| epoch   3 |    30/  173 batches | lr 0.001000 | 238.62 ms | loss 0.11340
| epoch   3 |    40/  173 batches | lr 0.001000 | 247.55 ms | loss 0.10735
| epoch   3 |    50/  173 batches | lr 0.001000 | 247.49 ms | loss 0.10972
| epoch   3 |    60/  173 batches | lr 0.001000 | 246.79 ms | loss 0.11038
| epoch   3 |    70/  173 batches | lr 0.001000 | 241.05 ms | loss 0.11134
| epoch   3 |    80/  173 batches | lr 0.001000 | 255.08 ms | loss 0.11051
| epoch   3 |    90/  173 batches | lr 0.001000 | 245.71 ms | loss 0.11140
| epoch   3 |   100/  173 batches | lr 0.001000 | 252.23 ms | loss 0.11027
| epoch   3 |   110/  173 batches | lr 0.001000 | 259.19 ms | loss 0.11002
| epoch   3 |   120/  173 batches | lr 0.001000 | 258.78 ms | loss 0.11203
| epoch   3 |   130/  173 batches | lr 0.001000 | 245.54 ms | loss 0.11007
| epoch   3 |   140/  173 batches | lr 0.001000 | 257.76 ms | loss 0.11466
| epoch   3 |   150/  173 batches | lr 0.001000 | 249.18 ms | loss 0.10614
| epoch   3 |   160/  173 batches | lr 0.001000 | 265.59 ms | loss 0.11440
| epoch   3 |   170/  173 batches | lr 0.001000 | 264.04 ms | loss 0.10873
data_source shape: torch.Size([11084, 2, 100, 6])
output shape: torch.Size([100, 1, 6])
output[[0]].shape: torch.Size([1, 1, 6])
output[:-1].shape: torch.Size([99, 1, 6])
truth shape: torch.Size([11183, 6])
test_result shape: torch.Size([11183, 6])
output truth shape: (11183, 6)
output test_result shape: (11183, 6)
test_result[0].shape, type (6,) float64
test_result.shape, type (11183, 6) float64
loss shape:  (11183, 6)
---------------------------------
start SVM
---------------------------------
精度为0.9691551184622262
precision:  0.6338797814207651  recall:  0.8923076923076924  acc:  0.9855137261915408  f1:  0.7412140575079873
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 145.26s | valid loss 0.10987
-----------------------------------------------------------------------------------------
save successfully
| epoch   4 |    10/  173 batches | lr 0.001000 | 260.41 ms | loss 0.11716
| epoch   4 |    20/  173 batches | lr 0.001000 | 251.26 ms | loss 0.10725
| epoch   4 |    30/  173 batches | lr 0.001000 | 240.31 ms | loss 0.11283
| epoch   4 |    40/  173 batches | lr 0.001000 | 242.60 ms | loss 0.10632
| epoch   4 |    50/  173 batches | lr 0.001000 | 234.63 ms | loss 0.10959
| epoch   4 |    60/  173 batches | lr 0.001000 | 231.87 ms | loss 0.10986
| epoch   4 |    70/  173 batches | lr 0.001000 | 225.49 ms | loss 0.11001
| epoch   4 |    80/  173 batches | lr 0.001000 | 235.64 ms | loss 0.11019
| epoch   4 |    90/  173 batches | lr 0.001000 | 227.32 ms | loss 0.11057
| epoch   4 |   100/  173 batches | lr 0.001000 | 228.89 ms | loss 0.11017
| epoch   4 |   110/  173 batches | lr 0.001000 | 223.31 ms | loss 0.10882
| epoch   4 |   120/  173 batches | lr 0.001000 | 227.07 ms | loss 0.11202
| epoch   4 |   130/  173 batches | lr 0.001000 | 227.84 ms | loss 0.10958
| epoch   4 |   140/  173 batches | lr 0.001000 | 232.23 ms | loss 0.11320
| epoch   4 |   150/  173 batches | lr 0.001000 | 226.96 ms | loss 0.10577
| epoch   4 |   160/  173 batches | lr 0.001000 | 234.94 ms | loss 0.11398
| epoch   4 |   170/  173 batches | lr 0.001000 | 232.70 ms | loss 0.10854
data_source shape: torch.Size([11084, 2, 100, 6])
output shape: torch.Size([100, 1, 6])
output[[0]].shape: torch.Size([1, 1, 6])
output[:-1].shape: torch.Size([99, 1, 6])
truth shape: torch.Size([11183, 6])
test_result shape: torch.Size([11183, 6])
output truth shape: (11183, 6)
output test_result shape: (11183, 6)
test_result[0].shape, type (6,) float64
test_result.shape, type (11183, 6) float64
loss shape:  (11183, 6)
---------------------------------
start SVM
---------------------------------
Traceback (most recent call last):
  File "train.py", line 150, in <module>
    main(args)
  File "train.py", line 115, in main
    val_loss = plot_and_loss(model, val_data, epoch, criterion, input_window, scaler, args.dim, labels)
  File "D:\PythonProject\Time_series_anomaly_detection\utils\plot_and_loss.py", line 104, in plot_and_loss
    clf = svm_c(loss_value, labels)
  File "D:\PythonProject\Time_series_anomaly_detection\utils\plot_and_loss.py", line 164, in svm_c
    clf = grid.fit(x_train, y_train)
  File "D:\miniconda\envs\pytorch\lib\site-packages\sklearn\model_selection\_search.py", line 891, in fit
    self._run_search(evaluate_candidates)
  File "D:\miniconda\envs\pytorch\lib\site-packages\sklearn\model_selection\_search.py", line 1768, in _run_search
    self.param_distributions, self.n_iter, random_state=self.random_state
  File "D:\miniconda\envs\pytorch\lib\site-packages\sklearn\model_selection\_search.py", line 851, in evaluate_candidates
    enumerate(candidate_params), enumerate(cv.split(X, y, groups))
  File "D:\miniconda\envs\pytorch\lib\site-packages\joblib\parallel.py", line 1056, in __call__
    self.retrieve()
  File "D:\miniconda\envs\pytorch\lib\site-packages\joblib\parallel.py", line 935, in retrieve
    self._output.extend(job.get(timeout=self.timeout))
  File "D:\miniconda\envs\pytorch\lib\site-packages\joblib\_parallel_backends.py", line 542, in wrap_future_result
    return future.result(timeout=timeout)
  File "D:\miniconda\envs\pytorch\lib\concurrent\futures\_base.py", line 430, in result
    self._condition.wait(timeout)
  File "D:\miniconda\envs\pytorch\lib\threading.py", line 296, in wait
    waiter.acquire()
KeyboardInterrupt