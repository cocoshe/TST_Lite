D:\PythonProject\Time_series_anomaly_detection\utils\data_prepare.py:17: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at  ..\torch\csrc\utils\tensor_new.cpp:201.)
  return torch.FloatTensor(inout_seq)
D:\PythonProject\Time_series_anomaly_detection\weights\2022_02_04 03_31_50
series:  0      66.25
1      73.18
2      79.95
3      69.91
4       0.00
       ...
194    27.90
195    50.60
196    19.60
197    26.10
198    31.20
Name: concentration, Length: 199, dtype: float64
-----------------------------------------------------------------------------------------
| end of epoch   1 | time:  1.39s | valid loss 0.40267
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch   2 | time:  1.34s | valid loss 0.05287
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch   3 | time:  1.36s | valid loss 0.21549
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch   4 | time:  1.11s | valid loss 0.17132
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch   5 | time:  1.11s | valid loss 0.07918
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch   6 | time:  1.12s | valid loss 0.07965
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch   7 | time:  1.16s | valid loss 0.04601
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch   8 | time:  1.12s | valid loss 0.06373
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch   9 | time:  1.12s | valid loss 0.05846
-----------------------------------------------------------------------------------------
loss shape:  torch.Size([197])
-----------------------------------------------------------------------------------------
| end of epoch  10 | time:  2.41s | valid loss 0.04673
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  11 | time:  1.14s | valid loss 0.04602
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  12 | time:  1.12s | valid loss 0.06099
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  13 | time:  1.15s | valid loss 0.05402
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  14 | time:  1.17s | valid loss 0.04642
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  15 | time:  1.39s | valid loss 0.04617
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  16 | time:  1.37s | valid loss 0.04659
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  17 | time:  1.21s | valid loss 0.04772
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  18 | time:  1.18s | valid loss 0.04515
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  19 | time:  1.15s | valid loss 0.04473
-----------------------------------------------------------------------------------------
save successfully
loss shape:  torch.Size([197])
-----------------------------------------------------------------------------------------
| end of epoch  20 | time:  2.59s | valid loss 0.04613
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  21 | time:  1.30s | valid loss 0.04591
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  22 | time:  1.16s | valid loss 0.04467
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  23 | time:  1.17s | valid loss 0.04440
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  24 | time:  1.22s | valid loss 0.04492
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  25 | time:  1.17s | valid loss 0.04536
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  26 | time:  1.14s | valid loss 0.04481
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  27 | time:  1.22s | valid loss 0.04460
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  28 | time:  1.19s | valid loss 0.04504
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  29 | time:  1.20s | valid loss 0.04504
-----------------------------------------------------------------------------------------
loss shape:  torch.Size([197])
-----------------------------------------------------------------------------------------
| end of epoch  30 | time:  2.55s | valid loss 0.04503
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  31 | time:  1.19s | valid loss 0.04449
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  32 | time:  1.23s | valid loss 0.04488
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  33 | time:  1.21s | valid loss 0.04464
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  34 | time:  1.18s | valid loss 0.04435
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  35 | time:  1.18s | valid loss 0.04445
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  36 | time:  1.15s | valid loss 0.04460
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  37 | time:  1.15s | valid loss 0.04445
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  38 | time:  1.10s | valid loss 0.04421
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  39 | time:  1.12s | valid loss 0.04403
-----------------------------------------------------------------------------------------
save successfully
loss shape:  torch.Size([197])
-----------------------------------------------------------------------------------------
| end of epoch  40 | time:  2.36s | valid loss 0.04455
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  41 | time:  1.13s | valid loss 0.04385
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  42 | time:  1.12s | valid loss 0.04358
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  43 | time:  1.13s | valid loss 0.04342
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  44 | time:  1.20s | valid loss 0.04311
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  45 | time:  1.15s | valid loss 0.04276
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  46 | time:  1.14s | valid loss 0.04238
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  47 | time:  1.16s | valid loss 0.04205
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  48 | time:  1.15s | valid loss 0.04149
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  49 | time:  1.12s | valid loss 0.04088
-----------------------------------------------------------------------------------------
save successfully
loss shape:  torch.Size([197])
-----------------------------------------------------------------------------------------
| end of epoch  50 | time:  2.56s | valid loss 0.04093
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  51 | time:  1.16s | valid loss 0.04001
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  52 | time:  1.15s | valid loss 0.03904
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  53 | time:  1.18s | valid loss 0.03905
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  54 | time:  1.16s | valid loss 0.03862
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  55 | time:  1.18s | valid loss 0.03889
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  56 | time:  1.13s | valid loss 0.03697
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  57 | time:  1.20s | valid loss 0.03973
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  58 | time:  1.14s | valid loss 0.03677
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  59 | time:  1.12s | valid loss 0.04300
-----------------------------------------------------------------------------------------
loss shape:  torch.Size([197])
-----------------------------------------------------------------------------------------
| end of epoch  60 | time:  2.39s | valid loss 0.03693
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  61 | time:  1.14s | valid loss 0.04004
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  62 | time:  1.12s | valid loss 0.03691
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  63 | time:  1.20s | valid loss 0.03936
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  64 | time:  1.14s | valid loss 0.03671
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  65 | time:  1.12s | valid loss 0.03872
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  66 | time:  1.13s | valid loss 0.03644
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  67 | time:  1.14s | valid loss 0.03851
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  68 | time:  1.16s | valid loss 0.03621
-----------------------------------------------------------------------------------------
save successfully
Traceback (most recent call last):
  File "train.py", line 133, in <module>
    main(args)
  File "train.py", line 95, in main
    train(train_data, input_window, model, optimizer, criterion, scheduler, epoch, batch_size)
  File "D:\PythonProject\Time_series_anomaly_detection\utils\train.py", line 19, in train
    output = model(data)
  File "D:\miniconda\envs\pytorch\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "D:\PythonProject\Time_series_anomaly_detection\model\Transformer.py", line 35, in forward
    output = self.transformer_encoder(src, self.src_mask)  # , self.src_mask)
  File "D:\miniconda\envs\pytorch\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "D:\miniconda\envs\pytorch\lib\site-packages\torch\nn\modules\transformer.py", line 198, in forward
    output = mod(output, src_mask=mask, src_key_padding_mask=src_key_padding_mask)
  File "D:\miniconda\envs\pytorch\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "D:\miniconda\envs\pytorch\lib\site-packages\torch\nn\modules\transformer.py", line 340, in forward
    x = self.norm2(x + self._ff_block(x))
  File "D:\miniconda\envs\pytorch\lib\site-packages\torch\nn\modules\transformer.py", line 355, in _ff_block
    x = self.linear2(self.dropout(self.activation(self.linear1(x))))
  File "D:\miniconda\envs\pytorch\lib\site-packages\torch\nn\modules\module.py", line 1102, in _call_impl
    return forward_call(*input, **kwargs)
  File "D:\miniconda\envs\pytorch\lib\site-packages\torch\nn\modules\dropout.py", line 58, in forward
    return F.dropout(input, self.p, self.training, self.inplace)
  File "D:\miniconda\envs\pytorch\lib\site-packages\torch\nn\functional.py", line 1169, in dropout
    return _VF.dropout_(input, p, training) if inplace else _VF.dropout(input, p, training)
KeyboardInterrupt