D:\PythonProject\Time_series_anomaly_detection\weights\2022_02_06 19_19_48
-----------------------------------------------
series:  0      29.9
1      30.6
2      24.8
3      37.2
4      21.0
       ...
304    41.7
305    35.3
306     0.0
307    39.8
308    41.9
Name: concentration, Length: 309, dtype: float64
series.shape:  (309,)
-----------------------------------------------
D:\PythonProject\Time_series_anomaly_detection\utils\data_prepare.py:19: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at  ..\torch\csrc\utils\tensor_new.cpp:201.)
  return torch.FloatTensor(inout_seq)
-----------------------------------------------------------------------------------------
| end of epoch   1 | time:  1.99s | valid loss 1.39814
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch   2 | time:  2.15s | valid loss 0.07696
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch   3 | time:  1.96s | valid loss 0.29838
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch   4 | time:  1.90s | valid loss 0.06355
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch   5 | time:  1.90s | valid loss 0.02789
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch   6 | time:  1.90s | valid loss 0.13065
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch   7 | time:  1.81s | valid loss 0.04329
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch   8 | time:  2.73s | valid loss 0.04216
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch   9 | time:  1.91s | valid loss 0.04555
-----------------------------------------------------------------------------------------
loss shape:  (307,)
-----------------------------------------------------------------------------------------
| end of epoch  10 | time:  3.45s | valid loss 0.04451
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  11 | time:  2.01s | valid loss 0.02764
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  12 | time:  1.99s | valid loss 0.03714
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  13 | time:  2.15s | valid loss 0.02763
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  14 | time:  2.17s | valid loss 0.02939
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  15 | time:  2.28s | valid loss 0.03087
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  16 | time:  2.08s | valid loss 0.02794
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  17 | time:  2.20s | valid loss 0.02830
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  18 | time:  2.36s | valid loss 0.02750
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  19 | time:  2.12s | valid loss 0.02732
-----------------------------------------------------------------------------------------
save successfully
loss shape:  (307,)
-----------------------------------------------------------------------------------------
| end of epoch  20 | time:  3.59s | valid loss 0.02810
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  21 | time:  2.01s | valid loss 0.02758
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  22 | time:  1.95s | valid loss 0.02742
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  23 | time:  1.90s | valid loss 0.02771
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  24 | time:  1.96s | valid loss 0.02760
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  25 | time:  1.98s | valid loss 0.02748
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  26 | time:  2.04s | valid loss 0.02759
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  27 | time:  1.90s | valid loss 0.02759
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  28 | time:  2.05s | valid loss 0.02750
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  29 | time:  2.05s | valid loss 0.02757
-----------------------------------------------------------------------------------------
loss shape:  (307,)
-----------------------------------------------------------------------------------------
| end of epoch  30 | time:  3.67s | valid loss 0.02778
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  31 | time:  1.90s | valid loss 0.02754
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  32 | time:  1.91s | valid loss 0.02755
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  33 | time:  2.01s | valid loss 0.02751
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  34 | time:  1.89s | valid loss 0.02743
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  35 | time:  1.96s | valid loss 0.02748
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  36 | time:  1.97s | valid loss 0.02746
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  37 | time:  1.98s | valid loss 0.02738
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  38 | time:  2.00s | valid loss 0.02739
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  39 | time:  1.97s | valid loss 0.02734
-----------------------------------------------------------------------------------------
loss shape:  (307,)
-----------------------------------------------------------------------------------------
| end of epoch  40 | time:  3.73s | valid loss 0.02746
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  41 | time:  1.91s | valid loss 0.02722
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  42 | time:  1.82s | valid loss 0.02709
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  43 | time:  1.82s | valid loss 0.02706
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  44 | time:  1.81s | valid loss 0.02697
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  45 | time:  1.88s | valid loss 0.02677
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  46 | time:  1.83s | valid loss 0.02655
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  47 | time:  1.88s | valid loss 0.02592
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  48 | time:  1.92s | valid loss 0.02491
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  49 | time:  1.80s | valid loss 0.02273
-----------------------------------------------------------------------------------------
save successfully
loss shape:  (307,)
-----------------------------------------------------------------------------------------
| end of epoch  50 | time:  3.47s | valid loss 0.01979
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  51 | time:  2.02s | valid loss 0.01890
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  52 | time:  1.98s | valid loss 0.01856
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  53 | time:  2.07s | valid loss 0.01827
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  54 | time:  1.96s | valid loss 0.02477
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  55 | time:  1.96s | valid loss 0.01959
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  56 | time:  1.97s | valid loss 0.02647
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  57 | time:  2.00s | valid loss 0.01941
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  58 | time:  1.96s | valid loss 0.02013
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  59 | time:  1.91s | valid loss 0.02096
-----------------------------------------------------------------------------------------
loss shape:  (307,)
-----------------------------------------------------------------------------------------
| end of epoch  60 | time:  3.72s | valid loss 0.01840
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  61 | time:  1.90s | valid loss 0.02034
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  62 | time:  1.91s | valid loss 0.01875
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  63 | time:  1.88s | valid loss 0.01825
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  64 | time:  1.83s | valid loss 0.01906
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  65 | time:  1.84s | valid loss 0.01817
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  66 | time:  1.79s | valid loss 0.01871
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  67 | time:  1.79s | valid loss 0.01878
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  68 | time:  1.83s | valid loss 0.01794
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  69 | time:  1.84s | valid loss 0.01852
-----------------------------------------------------------------------------------------
loss shape:  (307,)
-----------------------------------------------------------------------------------------
| end of epoch  70 | time:  3.43s | valid loss 0.01938
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  71 | time:  1.93s | valid loss 0.01764
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  72 | time:  1.80s | valid loss 0.01843
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  73 | time:  1.90s | valid loss 0.02052
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  74 | time:  1.90s | valid loss 0.01743
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  75 | time:  1.95s | valid loss 0.01861
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  76 | time:  2.61s | valid loss 0.01944
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  77 | time:  1.88s | valid loss 0.01728
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  78 | time:  2.03s | valid loss 0.01846
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  79 | time:  2.19s | valid loss 0.01896
-----------------------------------------------------------------------------------------
loss shape:  (307,)
-----------------------------------------------------------------------------------------
| end of epoch  80 | time:  3.67s | valid loss 0.01730
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  81 | time:  1.91s | valid loss 0.01822
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  82 | time:  2.13s | valid loss 0.01910
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  83 | time:  1.88s | valid loss 0.01707
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  84 | time:  2.12s | valid loss 0.01799
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  85 | time:  1.93s | valid loss 0.01931
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  86 | time:  1.91s | valid loss 0.01687
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch  87 | time:  1.98s | valid loss 0.01804
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  88 | time:  2.10s | valid loss 0.01908
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch  89 | time:  2.13s | valid loss 0.01679
-----------------------------------------------------------------------------------------
save successfully
Traceback (most recent call last):
  File "train.py", line 138, in <module>
    # print(args)
  File "train.py", line 100, in main
    epoch_start_time = time.time()
  File "D:\PythonProject\Time_series_anomaly_detection\utils\train.py", line 21, in train
    loss.backward()
  File "D:\miniconda\envs\pytorch\lib\site-packages\torch\_tensor.py", line 307, in backward
    torch.autograd.backward(self, gradient, retain_graph, create_graph, inputs=inputs)
  File "D:\miniconda\envs\pytorch\lib\site-packages\torch\autograd\__init__.py", line 156, in backward
    allow_unreachable=True, accumulate_grad=True)  # allow_unreachable flag
  File "D:\miniconda\envs\pytorch\lib\site-packages\wandb\wandb_torch.py", line 282, in <lambda>
    handle = var.register_hook(lambda grad: _callback(grad, log_track))
KeyboardInterrupt