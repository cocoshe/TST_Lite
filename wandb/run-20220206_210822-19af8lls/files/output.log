
D:\PythonProject\Time_series_anomaly_detection\weights\2022_02_06 21_08_28
train.py:86: DtypeWarning: Columns (1,2,3) have mixed types.Specify dtype option on import or set low_memory=False.
  train_data, val_data, timestamp, scaler = get_data(args, input_window, output_window, device=device)
find port id.
find polution id.
find company id.
         company_id                port_id polution_id       date  concentration   amount
0    17280000089583  64000000000600100000       w00000 2020-01-01          66.25   870.00
1    17280000089583  64000000000600100000       w00000 2020-01-02          73.18  1758.00
2    17280000089583  64000000000600100000       w00000 2020-01-03          79.95  1918.00
3    17280000089583  64000000000600100000       w00000 2020-01-04          69.91  1678.00
4    17280000089583  64000000000600100000       w00000 2020-01-05            NaN    74.00
5    17280000089583  64000000000600100000       w00000 2020-01-06            NaN   152.00
6    17280000089583  64000000000600100000       w00000 2020-01-20            NaN   156.00
7    17280000089583  64000000000600100000       w00000 2020-01-21            NaN    80.00
168  17280000089583  64000000000600100000       w00000 2020-01-07          34.50  2976.00
169  17280000089583  64000000000600100000       w00000 2020-01-08         112.50  9724.90
170  17280000089583  64000000000600100000       w00000 2020-01-09          26.80  2314.00
171  17280000089583  64000000000600100000       w00000 2020-01-10          22.40  1944.00
172  17280000089583  64000000000600100000       w00000 2020-01-11          20.60  1780.00
173  17280000089583  64000000000600100000       w00000 2020-01-12          19.30  1668.00
174  17280000089583  64000000000600100000       w00000 2020-01-13          20.20  1744.00
175  17280000089583  64000000000600100000       w00000 2020-01-14          21.70  1876.39
176  17280000089583  64000000000600100000       w00000 2020-01-15          33.80  2920.00
177  17280000089583  64000000000600100000       w00000 2020-01-16          32.10  2776.00
178  17280000089583  64000000000600100000       w00000 2020-01-17          20.50  1774.00
179  17280000089583  64000000000600100000       w00000 2020-01-18          23.70  2052.00
180  17280000089583  64000000000600100000       w00000 2020-01-19          29.80  2570.00
181  17280000089583  64000000000600100000       w00000 2020-01-22          24.80  2144.96
182  17280000089583  64000000000600100000       w00000 2020-01-23          20.90  1806.00
183  17280000089583  64000000000600100000       w00000 2020-01-24          19.50  1690.00
184  17280000089583  64000000000600100000       w00000 2020-01-25          19.80  1712.00
185  17280000089583  64000000000600100000       w00000 2020-01-26          27.70  2396.00
186  17280000089583  64000000000600100000       w00000 2020-01-27          45.00  3888.00
187  17280000089583  64000000000600100000       w00000 2020-01-28          20.40  1762.00
188  17280000089583  64000000000600100000       w00000 2020-01-29          22.80  1970.00
189  17280000089583  64000000000600100000       w00000 2020-01-30          20.10  1736.00
190  17280000089583  64000000000600100000       w00000 2020-01-31          20.50  1776.00
191  17280000089583  64000000000600100000       w00000 2020-02-01          20.60  1782.00
dim_name:  concentration
-----------------------------------------------
series:  0       66.25
1       73.18
2       79.95
3       69.91
4        0.00
5        0.00
6        0.00
7        0.00
168     34.50
169    112.50
170     26.80
171     22.40
172     20.60
173     19.30
174     20.20
175     21.70
176     33.80
177     32.10
178     20.50
179     23.70
180     29.80
181     24.80
182     20.90
183     19.50
184     19.80
185     27.70
186     45.00
187     20.40
188     22.80
189     20.10
190     20.50
191     20.60
Name: concentration, dtype: float64
series.shape:  (32,)
-----------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch   1 | time:  0.10s | valid loss 14.15435
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch   2 | time:  0.08s | valid loss 1.34228
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch   3 | time:  0.09s | valid loss 0.24565
-----------------------------------------------------------------------------------------
save successfully
-----------------------------------------------------------------------------------------
| end of epoch   4 | time:  0.11s | valid loss 0.57804
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch   5 | time:  0.09s | valid loss 0.27206
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch   6 | time:  0.09s | valid loss 0.34776
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch   7 | time:  0.08s | valid loss 0.42598
-----------------------------------------------------------------------------------------
-----------------------------------------------------------------------------------------
| end of epoch   8 | time:  0.09s | valid loss 0.19121
-----------------------------------------------------------------------------------------
save successfully
D:\PythonProject\Time_series_anomaly_detection\utils\data_prepare.py:18: UserWarning: Creating a tensor from a list of numpy.ndarrays is extremely slow. Please consider converting the list to a single numpy.ndarray with numpy.array() before converting to a tensor. (Triggered internally at  ..\torch\csrc\utils\tensor_new.cpp:201.)
  return torch.FloatTensor(inout_seq)
-----------------------------------------------------------------------------------------
| end of epoch   9 | time:  0.09s | valid loss 0.25059
-----------------------------------------------------------------------------------------
loss shape:  (30,)
Traceback (most recent call last):
  File "train.py", line 139, in <module>
    main(args)
  File "train.py", line 104, in main
    val_loss = plot_and_loss(model, val_data, epoch, criterion, input_window, timestamp, scaler, args.dim)
  File "D:\PythonProject\Time_series_anomaly_detection\utils\plot_and_loss.py", line 48, in plot_and_loss
    with open(res_csv_path, "w") as f:
PermissionError: [Errno 13] Permission denied: 'res/test_loss_concentration.csv'